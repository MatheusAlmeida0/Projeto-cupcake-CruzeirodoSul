<h2 class="mb-4">{{ isEditMode ? 'Editar Produto' : 'Novo Produto' }}</h2>

<div *ngIf="isLoading && isEditMode" class="text-center">
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Carregando...</span>
  </div>
</div>

<div *ngIf="errorMessage" class="alert alert-danger">
  {{ errorMessage }}
</div>

<form [formGroup]="produtoForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading">
  <div class="mb-3">
    <label for="nome" class="form-label">Nome do Cupcake</label>
    <input type="text" id="nome" class="form-control" formControlName="nome" required />
  </div>

  <div class="mb-3">
    <label for="caminho_imagem" class="form-label">URL da Imagem</label>
    <input
      type="text"
      id="caminho_imagem"
      class="form-control"
      formControlName="caminho_imagem"
      required
    />
  </div>

  <div class="mb-3">
    <label for="ingredientes" class="form-label">Ingredientes</label>
    <textarea
      id="ingredientes"
      class="form-control"
      formControlName="ingredientes"
      rows="3"
    ></textarea>
  </div>

  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="valor" class="form-label">Valor (R$)</label>
      <input
        type="number"
        id="valor"
        class="form-control"
        formControlName="valor"
        min="0.01"
        step="0.01"
        required
      />
    </div>
    <div class="col-md-6 mb-3">
      <label for="peso" class="form-label">Peso (g)</label>
      <input type="number" id="peso" class="form-control" formControlName="peso" />
    </div>
  </div>

  <fieldset class="mb-3 p-3 border rounded">
    <legend class="fs-6 fw-bold">Informações sobre Alergênicos</legend>
    <div class="form-check">
      <input
        class="form-check-input"
        type="checkbox"
        id="contem_gluten"
        formControlName="contem_gluten"
      />
      <label class="form-check-label" for="contem_gluten">Contém Glúten</label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="checkbox"
        id="contem_lactose"
        formControlName="contem_lactose"
      />
      <label class="form-check-label" for="contem_lactose">Contém Lactose</label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="checkbox"
        id="contem_leite"
        formControlName="contem_leite"
      />
      <label class="form-check-label" for="contem_leite">Contém Leite</label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="checkbox"
        id="contem_amendoim"
        formControlName="contem_amendoim"
      />
      <label class="form-check-label" for="contem_amendoim">Contém Amendoim</label>
    </div>
  </fieldset>

  <div class="d-flex justify-content-end">
    <button type="button" routerLink="/admin/produtos" class="btn btn-secondary me-2">
      Cancelar
    </button>
    <button type="submit" class="btn btn-primary" [disabled]="produtoForm.invalid || isLoading">
      <span
        *ngIf="isLoading"
        class="spinner-border spinner-border-sm"
        role="status"
        aria-hidden="true"
      ></span>
      {{ isLoading ? 'Salvando...' : 'Salvar' }}
    </button>
  </div>
</form>
